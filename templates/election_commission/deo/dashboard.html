{% extends "base.html" %}
{% set title = "DEO Dashboard" %}

{% block extra_css %}
<style>
/* ═══════════════════════════════════════════════════
   DEO DASHBOARD
═══════════════════════════════════════════════════ */
.deo-dashboard {
    min-height: calc(100vh - var(--nav-h));
    padding: 3.5rem 4rem 6rem;
    max-width: 1200px;
    margin: 0 auto;
}

/* ── PAGE HEADER ─────────────────────────────── */
.dash-header {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 2rem;
    align-items: start;
    margin-bottom: 3rem;
    padding-bottom: 2.5rem;
    border-bottom: 1px solid var(--border);
}

.dash-eyebrow {
    font-family: var(--font-mono);
    font-size: 0.62rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--indigo);
    display: flex; align-items: center; gap: 0.5rem;
    margin-bottom: 0.75rem;
}
.dash-eyebrow::before { content: ''; width: 20px; height: 1px; background: var(--indigo); }

.dash-title {
    font-family: var(--font-disp);
    font-size: clamp(2.5rem, 5vw, 4rem);
    line-height: 0.92;
    color: var(--text);
}
.dash-title span { color: var(--indigo); }

.dash-subtitle {
    font-family: var(--font-mono);
    font-size: 0.68rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--muted);
    margin-top: 0.75rem;
    line-height: 1.7;
    max-width: 480px;
}

.dash-header-right {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.75rem;
}

.role-badge {
    display: inline-flex; align-items: center; gap: 0.5rem;
    font-family: var(--font-mono); font-size: 0.6rem;
    letter-spacing: 0.15em; text-transform: uppercase;
    color: var(--indigo); background: var(--indigo-dim);
    border: 1px solid rgba(79,70,229,0.2);
    padding: 0.5rem 1rem;
}
.role-badge svg { width: 11px; height: 11px; stroke: var(--indigo); fill: none; stroke-width: 1.8; }

.district-badge {
    display: inline-flex; align-items: center; gap: 0.5rem;
    font-family: var(--font-mono); font-size: 0.6rem;
    letter-spacing: 0.12em; text-transform: uppercase;
    color: var(--muted); background: var(--ink-2);
    border: 1px solid var(--border); padding: 0.45rem 0.9rem;
}

/* ── QUICK ACTION ────────────────────────────── */
.action-strip {
    margin-bottom: 2.5rem;
}

.action-strip-label {
    font-family: var(--font-mono);
    font-size: 0.6rem; letter-spacing: 0.18em;
    text-transform: uppercase; color: var(--muted);
    margin-bottom: 1rem;
    display: flex; align-items: center; gap: 0.5rem;
}
.action-strip-label::before { content: ''; width: 12px; height: 1px; background: var(--indigo); }

.action-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
}

.action-card {
    background: var(--ink);
    padding: 2rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    text-decoration: none;
    position: relative; overflow: hidden;
    transition: background 0.2s;
}
.action-card::before {
    content: '';
    position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, var(--indigo), var(--teal));
    transform: scaleX(0); transform-origin: left;
    transition: transform 0.3s ease;
}
.action-card:hover { background: #fff; }
.action-card:hover::before { transform: scaleX(1); }

.action-card-icon {
    width: 42px; height: 42px;
    background: var(--indigo-dim);
    border: 1px solid rgba(79,70,229,0.2);
    display: grid; place-items: center;
    transition: background 0.2s, border-color 0.2s;
}
.action-card-icon svg {
    width: 20px; height: 20px;
    stroke: var(--indigo); fill: none;
    stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round;
}
.action-card:hover .action-card-icon { background: var(--indigo); border-color: var(--indigo); }
.action-card:hover .action-card-icon svg { stroke: #fff; }

.action-card-body {}
.action-card-title {
    font-family: var(--font-disp);
    font-size: 1.5rem; color: var(--text);
    margin-bottom: 0.3rem; line-height: 1;
    transition: color 0.2s;
}
.action-card:hover .action-card-title { color: var(--indigo); }
.action-card-desc {
    font-size: 0.8rem; color: var(--muted);
    line-height: 1.5;
}
.action-card-link {
    font-family: var(--font-mono); font-size: 0.62rem;
    letter-spacing: 0.12em; text-transform: uppercase;
    color: var(--indigo);
    display: inline-flex; align-items: center; gap: 0.4rem;
    margin-top: auto;
    transition: gap 0.2s;
}
.action-card:hover .action-card-link { gap: 0.7rem; }

/* ── BODY GRID ───────────────────────────────── */
.dash-body {
    display: grid;
    grid-template-columns: 1fr 340px;
    gap: 2rem;
    align-items: start;
}

/* ── RESPONSIBILITIES SECTION ────────────────── */
.responsibilities-card {
    border: 1px solid var(--border);
    background: #fff;
    overflow: hidden;
}
.responsibilities-head {
    padding: 1rem 1.5rem;
    background: var(--ink-2);
    border-bottom: 1px solid var(--border);
    font-family: var(--font-mono); font-size: 0.6rem;
    letter-spacing: 0.18em; text-transform: uppercase;
    color: var(--muted);
    display: flex; align-items: center; gap: 0.5rem;
}
.responsibilities-head svg {
    width: 12px; height: 12px;
    stroke: var(--indigo); fill: none; stroke-width: 1.5;
}
.responsibilities-body { padding: 0; }

.responsibility-item {
    display: flex; align-items: flex-start;
    gap: 1.25rem; padding: 1.25rem 1.5rem;
    border-bottom: 1px solid var(--border);
    transition: background 0.15s;
}
.responsibility-item:last-child { border-bottom: none; }
.responsibility-item:hover { background: var(--indigo-dim); }

.resp-num {
    width: 22px; height: 22px; flex-shrink: 0;
    background: var(--indigo-dim);
    border: 1px solid rgba(79,70,229,0.2);
    display: grid; place-items: center;
    font-family: var(--font-mono); font-size: 0.58rem;
    color: var(--indigo); font-weight: 700;
    margin-top: 1px;
}
.resp-content {}
.resp-title {
    font-family: var(--font-mono); font-size: 0.68rem;
    letter-spacing: 0.08em; text-transform: uppercase;
    color: var(--text); margin-bottom: 0.25rem;
}
.resp-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.55; }

/* ── SIDEBAR ─────────────────────────────────── */
.dash-sidebar { display: flex; flex-direction: column; gap: 1.5rem; }

.sidebar-card {
    border: 1px solid var(--border); background: #fff; overflow: hidden;
}
.sidebar-card-head {
    padding: 1rem 1.25rem;
    background: var(--ink-2); border-bottom: 1px solid var(--border);
    font-family: var(--font-mono); font-size: 0.6rem;
    letter-spacing: 0.18em; text-transform: uppercase; color: var(--muted);
    display: flex; align-items: center; gap: 0.5rem;
}
.sidebar-card-head svg {
    width: 12px; height: 12px; stroke: var(--indigo);
    fill: none; stroke-width: 1.5;
}
.sidebar-card-body { padding: 1.25rem; }

/* Hierarchy card */
.hierarchy-flow { display: flex; flex-direction: column; gap: 0; }
.hierarchy-item {
    display: flex; align-items: center; gap: 0.75rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--border);
}
.hierarchy-item:last-child { border-bottom: none; }
.hierarchy-dot {
    width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
}
.hierarchy-dot.cec { background: var(--warm); }
.hierarchy-dot.deo { background: var(--indigo); animation: pulse-ring 2s ease-in-out infinite; }
.hierarchy-dot.ro  { background: var(--teal); }
.hierarchy-label {
    font-family: var(--font-mono); font-size: 0.65rem;
    letter-spacing: 0.08em; text-transform: uppercase; color: var(--muted);
    flex: 1;
}
.hierarchy-item.current .hierarchy-label { color: var(--indigo); font-weight: 700; }
.hierarchy-you {
    font-family: var(--font-mono); font-size: 0.55rem;
    letter-spacing: 0.1em; text-transform: uppercase;
    color: var(--indigo); background: var(--indigo-dim);
    border: 1px solid rgba(79,70,229,0.2); padding: 0.1rem 0.4rem;
}
.hierarchy-connector {
    width: 1px; height: 12px; background: var(--border);
    margin-left: 3px; flex-shrink: 0;
}

/* Info items */
.info-items { display: flex; flex-direction: column; gap: 0.75rem; }
.info-item {
    display: flex; gap: 0.75rem; align-items: flex-start;
}
.info-item-icon {
    width: 20px; height: 20px; flex-shrink: 0;
    background: var(--indigo-dim); border: 1px solid rgba(79,70,229,0.15);
    display: grid; place-items: center; font-size: 0.6rem; margin-top: 1px;
}
.info-item p { font-size: 0.78rem; color: var(--muted); line-height: 1.55; }
.info-item p strong { color: var(--text); }

/* ── RESPONSIVE ──────────────────────────────── */
@media (max-width: 1024px) {
    .deo-dashboard { padding: 2.5rem 2rem 4rem; }
    .dash-body { grid-template-columns: 1fr; }
    .dash-sidebar { order: -1; }
    .dash-header { grid-template-columns: 1fr; }
    .dash-header-right { align-items: flex-start; flex-direction: row; flex-wrap: wrap; }
}
@media (max-width: 640px) {
    .deo-dashboard { padding: 2rem 1.25rem 4rem; }
}
</style>
{% endblock %}


{% block content %}
<div class="deo-dashboard">

    <!-- ── PAGE HEADER ────────────────────────────── -->
    <div class="dash-header reveal">
        <div>
            <div class="dash-eyebrow">Election Commission Portal</div>
            <h1 class="dash-title">DEO<br><span>Dashboard</span></h1>
            <p class="dash-subtitle">
                District Election Officer · Oversee Returning Officers,
                coordinate constituencies, and monitor election preparedness within your district.
            </p>
        </div>
        <div class="dash-header-right">
            <span class="role-badge">
                <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                District Election Officer
            </span>
            {% if session.get('district') %}
            <span class="district-badge">{{ session.get('district') }}</span>
            {% endif %}
        </div>
    </div>

    <!-- ── QUICK ACTIONS ──────────────────────────── -->
    <div class="action-strip reveal">
        <div class="action-strip-label">Quick Actions</div>
        <div class="action-cards">
            <a href="{{ url_for('election_commission.manage_ro') }}" class="action-card">
                <div class="action-card-icon">
                    <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                </div>
                <div class="action-card-body">
                    <div class="action-card-title">Returning Officers</div>
                    <div class="action-card-desc">Manage ROs assigned to constituencies within your district</div>
                </div>
                <span class="action-card-link">
                    Manage ROs →
                </span>
            </a>

            <a href="{{ url_for('public.election_schedule') }}" class="action-card">
                <div class="action-card-icon">
                    <svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                </div>
                <div class="action-card-body">
                    <div class="action-card-title">Election Schedule</div>
                    <div class="action-card-desc">View upcoming elections and their timelines</div>
                </div>
                <span class="action-card-link">
                    View Schedule →
                </span>
            </a>

            <a href="{{ url_for('public_results.dashboard') }}" class="action-card">
                <div class="action-card-icon">
                    <svg viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
                </div>
                <div class="action-card-body">
                    <div class="action-card-title">Election Results</div>
                    <div class="action-card-desc">Monitor live and final constituency results</div>
                </div>
                <span class="action-card-link">
                    View Results →
                </span>
            </a>
        </div>
    </div>

    <!-- ── BODY GRID ──────────────────────────────── -->
    <div class="dash-body">

        <!-- Responsibilities -->
        <div class="responsibilities-card reveal">
            <div class="responsibilities-head">
                <svg viewBox="0 0 24 24"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
                DEO Responsibilities
            </div>
            <div class="responsibilities-body">
                <div class="responsibility-item">
                    <div class="resp-num">1</div>
                    <div class="resp-content">
                        <div class="resp-title">Manage Returning Officers</div>
                        <div class="resp-desc">Appoint, monitor, and coordinate Returning Officers (ROs) responsible for individual constituencies in your district.</div>
                    </div>
                </div>
                <div class="responsibility-item">
                    <div class="resp-num">2</div>
                    <div class="resp-content">
                        <div class="resp-title">Constituency Coordination</div>
                        <div class="resp-desc">Ensure proper operational coordination across all constituencies — logistics, communication, and readiness checks.</div>
                    </div>
                </div>
                <div class="responsibility-item">
                    <div class="resp-num">3</div>
                    <div class="resp-content">
                        <div class="resp-title">Election Preparedness</div>
                        <div class="resp-desc">Monitor and report on district-level preparedness for each phase of the election, escalating issues to the CEO.</div>
                    </div>
                </div>
                <div class="responsibility-item">
                    <div class="resp-num">4</div>
                    <div class="resp-content">
                        <div class="resp-title">Result Monitoring</div>
                        <div class="resp-desc">Oversee the collation and publication of constituency results, ensuring accuracy and blockchain verification.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="dash-sidebar">

            <!-- Hierarchy card -->
            <div class="sidebar-card reveal">
                <div class="sidebar-card-head">
                    <svg viewBox="0 0 24 24"><path d="M8 6H21M8 12H21M8 18H21M3 6h.01M3 12h.01M3 18h.01"/></svg>
                    Your Position
                </div>
                <div class="sidebar-card-body">
                    <div class="hierarchy-flow">
                        <div class="hierarchy-item">
                            <div class="hierarchy-dot cec"></div>
                            <span class="hierarchy-label">Chief Election Commissioner</span>
                        </div>
                        <div class="hierarchy-connector"></div>
                        <div class="hierarchy-item">
                            <div class="hierarchy-dot cec" style="background:var(--muted);opacity:0.4"></div>
                            <span class="hierarchy-label">CEO / EC Officer</span>
                        </div>
                        <div class="hierarchy-connector"></div>
                        <div class="hierarchy-item current">
                            <div class="hierarchy-dot deo"></div>
                            <span class="hierarchy-label">District Election Officer</span>
                            <span class="hierarchy-you">You</span>
                        </div>
                        <div class="hierarchy-connector"></div>
                        <div class="hierarchy-item">
                            <div class="hierarchy-dot ro"></div>
                            <span class="hierarchy-label">Returning Officers (RO)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Info card -->
            <div class="sidebar-card reveal">
                <div class="sidebar-card-head">
                    <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                    Important Notes
                </div>
                <div class="sidebar-card-body">
                    <div class="info-items">
                        <div class="info-item">
                            <div class="info-item-icon">⛓</div>
                            <p>All election data is <strong>immutably recorded</strong> on the blockchain. Actions taken here are permanent and publicly auditable.</p>
                        </div>
                        <div class="info-item">
                            <div class="info-item-icon">↑</div>
                            <p>Escalate unresolved issues to the <strong>Chief Election Officer</strong> via the EC portal immediately.</p>
                        </div>
                        <div class="info-item">
                            <div class="info-item-icon">✓</div>
                            <p>Ensure all ROs in your district are <strong>active and verified</strong> before election day.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>
{% endblock %}